# Self-Reflection Prompt Pattern

## 説明  
Self-Reflection Prompt Pattern は、LLM に自身の出力を客観的に評価・検証させ、修正や補足を行うプロセスを組み込む設計手法です。  
- **二段階生成**：  
  1. 初回出力を得る  
  2. 「この回答の誤りや抜けを指摘し、改善版を生成してください」といったリフレクション用プロンプトを適用  
- **チェイン・オブ・リフレクション**：誤り検出→改善提案→再生成の各ステップを明示的に分ける  
- **メタ認知**：出力を「人間のように」評価させるため、評価基準（正確性、一貫性、網羅性など）をプロンプト内で提示  

## 用途  
- **高精度テキスト生成**：法務文書、医療レポート、学術要約など誤りが許されないドメイン  
- **質問応答システム**：ユーザへの回答を自己検証し、矛盾や誤情報を低減  
- **コード生成アシスタント**：生成コードのバグやスタイル違反を自己レビュー  
- **クリエイティブライティング**：プロットやキャラクター設定の整合性チェック  

## 解決する課題  
1. **出力精度のばらつき**  
   - 一度のプロンプトで誤情報や抜けが混ざるリスク  
2. **信頼性不足**  
   - ユーザが生成結果をそのまま利用して重大なミスを招く  
3. **手動レビューコスト**  
   - 人手による検証・修正フェーズの工数が大きい  

## 対象とするシステム／プロジェクト  
- **金融・医療ドメイン**：誤りがビジネスリスクにつながる文書生成  
- **リーガルテック**：契約書ドラフトの初期生成＋自動法律チェック  
- **開発支援ツール**：AI コード生成→Lint／静的解析→自己修正ループ  
- **学術プラットフォーム**：論文要旨の自動生成と自己検証  

## 利用するメリット  
- **精度向上**：LLM 自身の評価で誤りや抜けを自動補完  
- **自動化**：人手レビューを大幅に削減し、開発効率を向上  
- **一貫性**：複数回答の品質を均質化  
- **継続的改善**：反復的なリフレクションで同一プロンプト精度が高まる  

## 注意点とトレードオフ  
- **コスト増**：反省ステップ分の追加 API コールが発生  
- **レイテンシ増**：二段階以上の生成で応答時間が延長  
- **評価バイアス**：LLM の自己評価が過信や偏りを招く場合がある  
- **プロンプト設計負荷**：リフレクション用プロンプトのチューニングが必要  

## 導入のヒント  
1. **小規模 PoC で効果測定**  
   - まずは 1 回の自己検証ステップだけ追加し、精度向上率を評価  
2. **評価基準を明文化**  
   - 正確性、一貫性、網羅性などチェック項目をテンプレート化  
3. **部分適用から開始**  
   - 全文ではなく重要セクションのみ自己検証する部分適用を試す  
4. **メトリクス収集**  
   - 反省前後のエラー率・ユーザフィードバックをトラッキング  
5. **段階的拡張**  
   - チェイン・オブ・リフレクションのステップ数や深度を徐々に増やす  
